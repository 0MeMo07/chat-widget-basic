/*! For license information please see 695.chat-widget.js.LICENSE.txt */
"use strict";(this.webpackChunkChatWidget=this.webpackChunkChatWidget||[]).push([[695],{504:(e,t,r)=>{r.d(t,{A:()=>a});const a=(0,r(407).A)("message-square",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},571:(e,t,r)=>{r.d(t,{n:()=>c});var a=r(848),n=r(12),s=r(715),i=r(164),o=r(856);function l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.QP)((0,i.$)(e))}function c(e){var t=e.children,r=e.as,i=void 0===r?"p":r,o=e.className,c=e.duration,u=void 0===c?2:c,d=e.spread,h=void 0===d?2:d,g=(0,s.P)(i),x=(0,n.useMemo)((function(){return t.length*h}),[t,h]);return(0,a.jsx)(g,{className:l("relative inline-block bg-[length:250%_100%,auto] bg-clip-text","text-transparent [--base-color:#a1a1aa] [--base-gradient-color:#000]","[--bg:linear-gradient(90deg,#0000_calc(50%-var(--spread)),var(--base-gradient-color),#0000_calc(50%+var(--spread)))] [background-repeat:no-repeat,padding-box]","dark:[--base-color:#71717a] dark:[--base-gradient-color:#ffffff] dark:[--bg:linear-gradient(90deg,#0000_calc(50%-var(--spread)),var(--base-gradient-color),#0000_calc(50%+var(--spread)))]",o),initial:{backgroundPosition:"100% center"},animate:{backgroundPosition:"0% center"},transition:{repeat:1/0,duration:u,ease:"linear"},style:{"--spread":"".concat(x,"px"),backgroundImage:"var(--bg), linear-gradient(var(--base-color), var(--base-color))"},children:t})}},661:(e,t,r)=>{r.d(t,{EQ:()=>c,W8:()=>u,o8:()=>s,rD:()=>l});var a=r(888),n=null,s=function(e){n=e},i=function(){return n},o=(0,a.xP)({reducerPath:"chatApi",baseQuery:(0,a.cw)({baseUrl:"https://smake.runasp.net/api/"}),endpoints:function(e){return{createChat:e.mutation({query:function(){return{url:"Semantic/chat/create",method:"POST"}},transformResponse:function(e){return{sessionId:e.chatId||e.sessionId}}}),sendMessage:e.mutation({query:function(e){var t=i();if(!t)throw new Error("No chat session found");return{url:"Semantic/chat/".concat(t),method:"POST",headers:{"Content-Type":"application/json"},body:e}}}),streamMessage:e.mutation({query:function(e){var t=i();if(!t)throw new Error("No chat session found");return{url:"Semantic/chat/".concat(t,"/stream"),method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream"},body:e,responseHandler:"text"}}})}}}),l=o.useCreateChatMutation,c=o.useSendMessageMutation,u=o.useStreamMessageMutation},695:(e,t,r)=>{r.r(t),r.d(t,{default:()=>v});var a=r(848),n=r(12),s=r(715),i=r(221),o=r(504),l=r(640),c=r(539),u=r(676),d=r(697);const h=(0,r(407).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);var g=r(686),x=r(775),m=r(571),f=r(661),p=function(e,t,r,a){return new(r||(r=Promise))((function(n,s){function i(e){try{l(a.next(e))}catch(e){s(e)}}function o(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,o)}l((a=a.apply(e,t||[])).next())}))},b=function(e,t){var r,a,n,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(r=1,a&&(n=2&o[0]?a.return:o[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,o[1])).done)return n;switch(a=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},y=function(e,t,r){if(r||2===arguments.length)for(var a,n=0,s=t.length;n<s;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))};function v(){var e=this,t=(0,n.useState)(!1),r=t[0],v=t[1],w=(0,n.useState)([]),j=w[0],N=w[1],k=(0,n.useState)(""),S=k[0],C=k[1],A=(0,n.useState)(!1),T=A[0],P=A[1],M=(0,n.useState)([]),z=(M[0],M[1],(0,n.useState)(!1)),E=z[0],I=z[1],B=(0,n.useRef)(null),O=(0,f.rD)()[0],D=(0,f.EQ)()[0],q=(0,f.W8)()[0],H={chatContainer:T?"from-gray-800 to-gray-900 border-gray-700":"from-white to-gray-50 border-gray-200",toggleButton:T?"from-blue-600 to-blue-700":"from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700",header:T?"from-blue-600 to-blue-700":"from-blue-500 to-blue-600",headerThemeButton:"text-white hover:bg-white/20",messageBody:T?"bg-gray-800 text-gray-200":"bg-gray-100 text-gray-800",aiAvatar:T?"bg-blue-900/50 text-blue-400":"bg-blue-100 text-blue-600",userAvatar:T?"bg-gray-800 text-gray-400":"bg-gray-100 text-gray-600",hotelCard:T?"bg-gray-800":"bg-white",hotelPrice:T?"bg-gray-900/90 text-blue-400":"bg-white/90 text-blue-600",hotelTitle:T?"text-gray-100":"text-gray-900",hotelDescription:T?"text-gray-400":"text-gray-600",hotelLocation:T?"text-gray-400":"text-gray-600",hotelAmenity:T?"bg-blue-900/30 text-blue-400":"bg-blue-50 text-blue-600",inputContainer:T?"border-gray-700 bg-gray-800":"border-gray-200 bg-white",textInput:T?"border-gray-700 bg-gray-900 text-gray-200 placeholder-gray-400 focus:ring-blue-600":"border-gray-200 bg-gray-50 text-gray-800 placeholder-gray-500 focus:ring-blue-500",sendButton:T?"from-blue-600 to-blue-700":"from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700"};(0,n.useEffect)((function(){p(e,void 0,void 0,(function(){var e,t;return b(this,(function(a){switch(a.label){case 0:if(!r||E)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,O().unwrap()];case 2:return e=a.sent(),console.log("Chat session created:",e),(0,f.o8)(e.sessionId),I(!0),N([{sender:"ai",text:"Merhaba! ðŸ‘‹ Size en uygun oteli bulmak iÃ§in buradayÄ±m. NasÄ±l yardÄ±mcÄ± olabilirim?"}]),[3,4];case 3:return t=a.sent(),console.error("Chat initialization failed:",t),[3,4];case 4:return[2]}}))}))}),[r,E]),(0,n.useEffect)((function(){!function(){var e;null===(e=B.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}()}),[j]);var W=function(){return p(e,void 0,void 0,(function(){var e,t,r,a,n,s,i,o,l,c,u,d,h,g,x,m,p,v,w,j;return b(this,(function(b){switch(b.label){case 0:if(!S.trim())return[2];e={sender:"user",text:S},t={sender:"ai",text:"Size en uygun otelleri arÄ±yorum...",isThinking:!0},N((function(r){return y(y([],r,!0),[e,t],!1)})),C(""),b.label=1;case 1:return b.trys.push([1,10,,16]),[4,q({userMessage:S,systemMessage:"You are a helpful travel assistant."}).unwrap()];case 2:if(!((r=b.sent())instanceof Response))return[3,7];if(!(a=null===(j=r.body)||void 0===j?void 0:j.getReader()))return[3,6];n=new TextDecoder,s="",b.label=3;case 3:return[4,a.read()];case 4:if(i=b.sent(),o=i.done,l=i.value,o)return[3,5];for(s+=n.decode(l,{stream:!0}),c=s.split("\n"),s=c.pop()||"",u=function(e){if(e.startsWith("data: ")){var t=e.slice(6);try{var r=JSON.parse(t);N((function(e){var t=y([],e,!0),a=t[t.length-1];return a.isThinking&&(a.text=r.message||r.content||r,a.isThinking=!1),t}))}catch(e){console.error("Failed to parse SSE data:",e)}}},d=0,h=c;d<h.length;d++)g=h[d],u(g);return[3,3];case 5:if(s)try{x=JSON.parse(s),N((function(e){var t=y([],e,!0),r=t[t.length-1];return r.isThinking&&(r.text=x.message||x.content||x,r.isThinking=!1),t}))}catch(e){console.error("Failed to parse remaining SSE data:",e)}b.label=6;case 6:return[3,9];case 7:return[4,D({userMessage:S,systemMessage:"You are a helpful travel assistant."}).unwrap()];case 8:m=b.sent(),N((function(e){var t=y([],e,!0);return t.pop(),t.push({sender:"ai",text:m.message,suggestions:[]}),t})),b.label=9;case 9:return[3,16];case 10:if(p=b.sent(),console.error("Failed to send message:",p),!(p instanceof Error&&p.message.includes("chat session")))return[3,15];b.label=11;case 11:return b.trys.push([11,14,,15]),[4,O().unwrap()];case 12:return v=b.sent(),(0,f.o8)(v.sessionId),[4,W()];case 13:return b.sent(),[2];case 14:return w=b.sent(),console.error("Failed to create new session:",w),[3,15];case 15:return N((function(e){var t=y([],e,!0);return t.pop(),t.push({sender:"ai",text:"ÃœzgÃ¼nÃ¼m, bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin."}),t})),[3,16];case 16:return[2]}}))}))};return(0,a.jsxs)("div",{className:"fixed bottom-6 right-6 z-50",children:[(0,a.jsx)(s.P.button,{onClick:function(){return v(!r)},whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-gradient-to-r ".concat(H.toggleButton," text-white p-4 rounded-2xl shadow-lg hover:shadow-xl focus:outline-none transition-all duration-300"),children:(0,a.jsx)(o.A,{className:"w-6 h-6"})}),(0,a.jsx)(i.N,{children:r&&(0,a.jsxs)(s.P.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.95},transition:{duration:.2},className:"absolute bottom-20 right-0 w-[400px] rounded-2xl overflow-hidden shadow-2xl bg-gradient-to-b ".concat(H.chatContainer," border"),children:[(0,a.jsx)("div",{className:"p-4 bg-gradient-to-r ".concat(H.header),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center backdrop-blur-sm",children:(0,a.jsx)(l.A,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-white font-medium",children:"Otel AsistanÄ±"}),(0,a.jsx)("p",{className:"text-blue-100 text-sm",children:"Her zaman yardÄ±ma hazÄ±r"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:function(){P((function(e){return!e}))},className:"p-2 rounded-xl ".concat(H.headerThemeButton," transition-colors"),children:T?(0,a.jsx)(c.A,{className:"w-5 h-5 text-white"}):(0,a.jsx)(u.A,{className:"w-5 h-5 text-white"})}),(0,a.jsx)("button",{onClick:function(){return v(!1)},className:"p-2 rounded-xl ".concat(H.headerThemeButton," transition-colors"),children:(0,a.jsx)(d.A,{className:"w-5 h-5 text-white"})})]})]})}),(0,a.jsxs)("div",{className:"h-[500px] overflow-y-auto p-4 space-y-4",children:[j.map((function(e,t){return(0,a.jsxs)(s.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex gap-3",children:["ai"===e.sender&&(0,a.jsx)("div",{className:"w-8 h-8 rounded-xl ".concat(H.aiAvatar," flex items-center justify-center flex-shrink-0"),children:(0,a.jsx)(l.A,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 ".concat("user"===e.sender?"ml-auto":"mr-auto"),children:[(0,a.jsx)("div",{className:"px-4 py-2 rounded-2xl text-sm max-w-[280px] ".concat("user"===e.sender?"bg-gradient-to-r from-blue-500 to-blue-600 text-white ml-auto":(e.isThinking,H.messageBody)),children:e.isThinking?(0,a.jsx)(m.n,{duration:1.5,spread:1.5,children:"Size en uygun otelleri arÄ±yorum..."}):e.text}),e.suggestions&&(0,a.jsx)("div",{className:"grid gap-3 mt-2",children:e.suggestions.map((function(e,t){var r;return(0,a.jsxs)(s.P.div,{whileHover:{scale:1.02},className:"".concat(H.hotelCard," rounded-2xl overflow-hidden shadow-md hover:shadow-lg transition-all duration-300"),children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("img",{src:e.image,alt:e.title,className:"w-full h-40 object-cover"}),(0,a.jsx)("div",{className:"absolute top-2 right-2 ".concat(H.hotelPrice," backdrop-blur-sm px-2 py-1 rounded-lg text-sm font-medium"),children:e.price})]}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsx)("h4",{className:"font-medium ".concat(H.hotelTitle),children:e.title}),(0,a.jsxs)("div",{className:"flex items-center gap-1 text-yellow-500",children:[(0,a.jsx)("span",{children:"â˜…"}),(0,a.jsx)("span",{className:"text-sm",children:e.rating})]})]}),(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-1 text-sm ".concat(H.hotelLocation),children:[(0,a.jsx)(h,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:e.location})]}),(0,a.jsx)("p",{className:"mt-2 text-sm ".concat(H.hotelDescription),children:e.description}),(0,a.jsx)("div",{className:"mt-3 flex flex-wrap gap-2",children:null===(r=e.amenities)||void 0===r?void 0:r.map((function(e,t){return(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded-lg ".concat(H.hotelAmenity),children:e},t)}))})]})]},t)}))})]}),"user"===e.sender&&(0,a.jsx)("div",{className:"w-8 h-8 rounded-xl ".concat(H.userAvatar," flex items-center justify-center flex-shrink-0"),children:(0,a.jsx)(g.A,{className:"w-5 h-5"})})]},t)})),(0,a.jsx)("div",{ref:B})]}),(0,a.jsx)("div",{className:"p-4 border-t ".concat(H.inputContainer),children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"text",className:"flex-1 px-4 py-2 rounded-xl border ".concat(H.textInput," focus:outline-none focus:ring-2 transition-all"),placeholder:"Otel tercihinizi yazÄ±n...",value:S,onChange:function(e){return C(e.target.value)},onKeyDown:function(e){return"Enter"===e.key&&W()}}),(0,a.jsx)("button",{onClick:W,className:"p-2 rounded-xl bg-gradient-to-r ".concat(H.sendButton," text-white transition-all duration-300"),children:(0,a.jsx)(x.A,{className:"w-5 h-5"})})]})})]})})]})}}}]);